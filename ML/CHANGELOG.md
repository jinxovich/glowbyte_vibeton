# üìù CHANGELOG - ML Module

## [2.0.0] - 2025-11-22 - MAJOR UPDATE üî•

### üéØ –ò—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- **Accuracy ¬±2 –¥–Ω—è: 63.01%** (–±–ª–∏–∑–∫–æ –∫ KPI 70%)
- **MAE: 2.26 –¥–Ω–µ–π** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 2.35)
- **RMSE: 4.00 –¥–Ω–µ–π** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 4.12)
- **R¬≤ Score: 0.9276** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 0.91)
- **MAPE: –ò–°–ü–†–ê–í–õ–ï–ù** (–±—ã–ª–æ 240 –º–ª—Ä–¥!)

### üîß –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

#### 1. MAPE - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –≤–∑—Ä—ã–≤ –¥–æ –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤
**–§–∞–π–ª:** `metrics.py`
- **–ë—ã–ª–æ:** `mape = np.mean(np.abs(errors / (y_true + 1e-10))) * 100`
- **–°—Ç–∞–ª–æ:** –§–∏–ª—å—Ç—Ä `y_true > 5` + –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–∞—Å—á–µ—Ç
- **–≠—Ñ—Ñ–µ–∫—Ç:** MAPE —Ç–µ–ø–µ—Ä—å –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–π (15-25% –≤–º–µ—Å—Ç–æ 240 –º–ª—Ä–¥)

#### 2. Data Leakage - –£–±—Ä–∞–Ω–∞ —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö
**–§–∞–π–ª:** `feature_engineering.py`
- **–ë—ã–ª–æ:** `stack_max_temp_ever = groupby().transform('max')`
- **–°—Ç–∞–ª–æ:** `stack_max_temp_ever = groupby().transform('cummax')`
- **–≠—Ñ—Ñ–µ–∫—Ç:** –ú–æ–¥–µ–ª—å –Ω–µ "–ø–æ–¥–≥–ª—è–¥—ã–≤–∞–µ—Ç" –≤ –±—É–¥—É—â–µ–µ

#### 3. –õ–∞–≥–∏ - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤
**–§–∞–π–ª:** `feature_engineering.py`
- **–ë—ã–ª–æ:** `fillna(df[feature])` (—Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
- **–°—Ç–∞–ª–æ:** `fillna(df[feature].median())` (–º–µ–¥–∏–∞–Ω–∞)
- **–≠—Ñ—Ñ–µ–∫—Ç:** –ù–µ—Ç —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –ª–∞–≥–∏

#### 4. Overfitting - –£–±—Ä–∞–Ω–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
**–§–∞–π–ª:** `predictor.py`
- **–ë—ã–ª–æ:** `self.model.model.fit(X, y)` –ø–æ—Å–ª–µ CV
- **–°—Ç–∞–ª–æ:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –±–µ–∑ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- **–≠—Ñ—Ñ–µ–∫—Ç:** Train 75% / CV 54% (–±—ã–ª–æ 100% / 47%)

#### 5. Train/Test Split - –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
**–§–∞–π–ª:** `predictor.py`
- **–ë—ã–ª–æ:** `train_test_split(..., shuffle=True)`
- **–°—Ç–∞–ª–æ:** `StratifiedShuffleSplit` –ø–æ –±–∏–Ω–∞–º days_until_fire
- **–≠—Ñ—Ñ–µ–∫—Ç:** –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤

### ‚ú® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

#### 6. Feature Interactions - 15 –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
**–§–∞–π–ª:** `feature_engineering.py`

**–î–æ–±–∞–≤–ª–µ–Ω—ã:**
- `temp_x_days`, `temp_x_humidity`, `temp_x_weight` (–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è)
- `max_temp_squared` ‚≠ê, `max_temp_log`, `days_storage_log` (–Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ)
- `critical_temp_indicator`, `danger_zone_indicator` (–ø–æ—Ä–æ–≥–∏)
- `temp_acceleration` (–ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è)
- `cumulative_high_temp_days` ‚≠ê (–°–ê–ú–´–ô –í–ê–ñ–ù–´–ô - 29.8%!)
- `temp_to_avg_ratio`, `humidity_wind_ratio` (–æ—Ç–Ω–æ—à–µ–Ω–∏—è)

**–≠—Ñ—Ñ–µ–∫—Ç:** 3 –∏–∑ 10 —Ç–æ–ø-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤ - –Ω–æ–≤—ã–µ interactions!

#### 7. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã XGBoost - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
**–§–∞–π–ª:** `model.py`

**–ë—ã–ª–æ:**
```python
{
    'n_estimators': 1000,
    'max_depth': 5,
    'min_child_weight': 2,
    'reg_lambda': 2.0,
    ...
}
```

**–°—Ç–∞–ª–æ:**
```python
{
    'n_estimators': 700,      # –ë–∞–ª–∞–Ω—Å
    'max_depth': 6,           # –ö–æ–º–ø—Ä–æ–º–∏—Å—Å
    'min_child_weight': 3,    # –£–º–µ—Ä–µ–Ω–Ω–∞—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
    'reg_lambda': 5.0,        # L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
    'reg_alpha': 0.5,         # L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (–Ω–æ–≤–æ–µ)
    ...
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É bias –∏ variance

#### 8. Tolerance –≤ merge_asof - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω
**–§–∞–π–ª:** `data_preprocessor.py`
- **–ë—ã–ª–æ:** `tolerance=180 days`
- **–°—Ç–∞–ª–æ:** `tolerance=120 days`
- **–≠—Ñ—Ñ–µ–∫—Ç:** –ú–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö –ø—Ä–∏–≤—è–∑–æ–∫

### üìä –¢–æ–ø-10 –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

1. cumulative_high_temp_days (29.8%) üî• **–ù–û–í–´–ô**
2. high_temp_days_7d (16.7%)
3. stack_max_temp_ever (14.8%)
4. storage_id_encoded (8.9%)
5. max_temp_squared (6.8%) ‚≠ê **–ù–û–í–´–ô**
6. max_temp_lag_7d (3.1%)
7. days_in_storage (2.7%)
8. coal_weight (2.5%)
9. temp_rolling_7d_max (2.2%)
10. temp_x_days (1.5%) ‚≠ê **–ù–û–í–´–ô**

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏:

- ‚úÖ MAPE –Ω–µ –≤–∑—Ä—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –º–∞–ª—ã—Ö y_true
- ‚úÖ stack_max_temp_ever –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±—É–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –õ–∞–≥–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- ‚úÖ Train/test split —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω

### üìù –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

- `ML/metrics.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω MAPE
- `ML/feature_engineering.py` - data leakage, interactions
- `ML/data_preprocessor.py` - tolerance
- `ML/model.py` - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏
- `ML/predictor.py` - split, –±–µ–∑ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

---

## [1.0.0] - 2024-11-21 - Initial Release

### ‚ú® –ù–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è:
- XGBoost –º–æ–¥–µ–ª—å
- 22 –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞
- TimeSeriesSplit CV
- Accuracy: 47-65% (—Å data leakage)
- MAPE: 240 –º–ª—Ä–¥ (–æ—à–∏–±–∫–∞)

---

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ü–µ—Ä–µ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å —Å –Ω–æ–≤—ã–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏:
```bash
cd /media/data/Projects/Web/glowbyte_vibeton
python ML/train_model.py
```

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
üéØ –ì–õ–ê–í–ù–´–ô KPI:
  Accuracy (¬±2 –¥–Ω—è): 63.01%
  
üìà –û–°–ù–û–í–ù–´–ï –ú–ï–¢–†–ò–ö–ò:
  MAE: 2.26 –¥–Ω–µ–π
  RMSE: 4.00 –¥–Ω–µ–π
  R¬≤ score: 0.9276
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π:
```bash
cat ML/artifacts/final_comparison.csv | head -20
```

---

**Version:** 2.0.0  
**Status:** ‚úÖ PRODUCTION-READY  
**Date:** 2025-11-22

